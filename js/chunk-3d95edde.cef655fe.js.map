{"version":3,"sources":["webpack:///./node_modules/@jx3box/jx3box-talent/index.js","webpack:///./src/views/Talent.vue","webpack:///src/views/Talent.vue","webpack:///./src/views/Talent.vue?42e4","webpack:///./src/views/Talent.vue?c2a5","webpack:///./src/views/Talent.vue?4645"],"names":["__iconPath","__dataPath","JX3_QIXUE","opt","this","_default","version","container","xf","sq","editable","_qixue_url","_img_path","_total_levels","_item_attr_list","_data","isQQBrowser","window","navigator","userAgent","includes","txt","Array","code","overview","_init","_structureViewBox","_build","Promise","resolve","reject","ajax","url","dataType","success","data","error","undefined","extend","_checkParam","_getTalentData","_setConfig","_renderViewBox","_buildEditBox","t","_checkParamType","v","_checkParamsValue","__opt","isObject","isString","JSON","parse","e","console","__simplify","split","join","isBool","val","_checkParamSQ","_checkParamEditable","__editable","Boolean","__sq","length","map","_buildTalentOutputData","forEach","item","i","_record","push","id","icon","name","append","_box","children","_xfbox","_clist","_obox","__clist","repeat","_citems","__instance","__items","text","each","level","point","j","key","eq","attr","icon_url","find","parseInt","addClass","removeClass","_loadMetaEvent","__olist","html","_olist","ele","_bindEvent","_foldListEvent","_changeEvent","off","on","stopPropagation","index","siblings","toggleClass","hasClass","list","meta","is_skill","skill_type","desc","isNotExist","__html","wrapper_prefix","wrapper_suffix","$from","__order","parent","$to","toString","document","trigger","then","render","_vm","_c","_self","attrs","staticClass","_v","reload","model","value","callback","$$v","expression","_l","versions","_s","isLogin","$event","drawer","_e","xfMaps","xficon","parseSchema","copy","slot","isEditor","pzcode","currentSchema","save","isEditing","saveAs","updateDrawer","use","staticRenderFns","props","activeName","driver","schemas","User","showList","computed","schema_group","mount","_xfmap$this$xf","xfmap","params","client","type","cloneDeep","methods","_this","talent","_schema","load","$message","message","schema","_this2","success_message","_this3","putTalent","_objectSpread","$notify","title","$prompt","confirmButtonText","cancelButtonText","inputErrorMessage","inputValidator","_ref","addTalent","_this$currentSchema","_this4","inputValue","_ref2","stringify","parseCode","init","_this5","getTalentVersions","res","vm","$","ins","__data","__imgPath","mounted","watch","page","loadList","components","talentDrawer","AppLayout","component"],"mappings":"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","file":"js/chunk-3d95edde.cef655fe.js","sourcesContent":["/*\n * @Description: 奇穴模拟器\n * @Author: iRuxu\n * @Date: 2019-09-08 06:26:22\n * @LastEditors: iRuxu\n * @LastEditTime: 2020-06-10 05:02:40\n */\n\n/* ex. \n    Init :\n    let talent = new JX3_QIXUE([opt])\n\n    Reload :\n    talent.load(opt,[editable])\n\n*/\n\nimport _ from \"lodash\";\nimport $ from \"jquery\";\nimport JX3BOX from \"@jx3box/jx3box-common/data/jx3box.json\";\nconst {\n    __iconPath,\n    __dataPath,\n} = JX3BOX;\n\nclass JX3_QIXUE {\n    /**\n     * @param {object} opt 初始化参数\n     * opt.container     {string}    容器选择器\n     * opt.xf            {stirng}    心法\n     * opt.sq            {string}    序列\n     * opt.editable      {boolean}   是否为可编辑模式\n     */\n    constructor(opt) {\n        //构建器参数默认值\n        this._default = {\n            version: \"v20200522\",\n            container: \".qx-container\",\n            xf: \"其它\",\n            sq: \"1,1,1,1,1,1,1,1,1,1,1,1\",\n            editable: false,\n        };\n\n        //初始化字段\n        this._qixue_url = __dataPath + \"talent/\";\n        this._img_path = __iconPath + \"icon/\";\n        this._total_levels = 12; //奇穴共12重\n        this._item_attr_list = [\n            \"icon\", //图标id\n            \"name\", //奇穴名称\n            \"desc\", //奇穴描述\n            \"order\", //奇穴在第几重\n            \"pos\", //奇穴从上往下数的位置\n            \"is_skill\", //是否为技能\n            \"meta\", //技能短述\n            \"extend\", //技能长述\n        ];\n        this._data = {}; //格式化数据对象\n        this.isQQBrowser = window.navigator.userAgent.includes('QQBrowser')\n\n        // 未传递\n        if (!opt) opt = this._default;\n\n        // 导出内容\n        this.txt = new Array(this._total_levels); //文字版\n        this.code = {version:'',xf:'',sq:''}\n        this.overview = []\n\n        return this._init(opt);\n    }\n\n    //初始化实例\n    _init(opt) {\n        //构建基础视图\n        this._structureViewBox(opt);\n\n        //获取json源数据\n        return this._build(opt);\n    }\n\n    //获取奇穴数据\n    _getTalentData(opt) {\n        return new Promise((resolve, reject) => {\n            $.ajax({\n                url: this._qixue_url + opt.version + \".json\",\n                dataType: \"json\",\n                success: function (data) {\n                    resolve(data);\n                },\n                error: function (data) {\n                    reject(data);\n                },\n            });\n        });\n    }\n\n    //构建模拟器\n    async _build(opt) {\n        //参数检查\n        if (opt == undefined) {\n            opt = this._default;\n        } else {\n            opt = _.extend(this._default, opt);\n            opt = this._checkParam(opt);\n        }\n\n        //step.0 加载不同版本json文件\n        if (opt.version != this.version) {\n            this._data = await this._getTalentData(opt);\n        }\n\n        //step.1 配置参数\n        this._setConfig(opt);\n\n        //step.2 渲染视图数据\n        this._renderViewBox();\n\n        //step.3 是否构建编辑器\n        if (this.editable) this._buildEditBox();\n\n        return this;\n    }\n\n    //检查参数\n    _checkParam(opt) {\n        let t = this._checkParamType(opt);\n        let v = this._checkParamsValue(t);\n        return v;\n    }\n\n    //检查参数类型\n    _checkParamType(opt) {\n        let __opt = {};\n\n        if (_.isObject(opt)) {\n            __opt = opt;\n        }\n\n        if (_.isString(opt)) {\n            if (opt.includes(\"{\")) {\n                try {\n                    __opt = JSON.parse(opt);\n                } catch (e) {\n                    console.error(\"[checkParamType]无法解析字符串为合适对象\");\n                }\n            } else if (opt.includes(\",\")) {\n                try {\n                    let __simplify = opt.split(\",\");\n                    __opt.xf = __simplify[0];\n                    __opt.sq = __simplify[1].split(\"\").join(\",\");\n\n                    let isBool = function (val) {\n                        if (val == \"true\" || val == \"1\") return true;\n                        if (val == \"false\" || val == \"0\") return false;\n                    };\n                    __opt.editable = isBool(__simplify[2]);\n                } catch (e) {\n                    console.error(\"[checkParamType]无法解析字符串参数\");\n                }\n            } else {\n                console.error(\"[checkParamType]无法解析参数\");\n            }\n        }\n\n        return __opt;\n    }\n\n    //检查参数值\n    _checkParamsValue(opt) {\n        let __opt = opt;\n        //opt.xf && (__opt.xf = this._checkParamXF(opt.xf))\n        opt.sq && (__opt.sq = this._checkParamSQ(opt.sq));\n        opt.editable &&\n            (__opt.editable = this._checkParamEditable(opt.editable));\n        return __opt;\n    }\n\n    //检查模式\n    _checkParamEditable(editable) {\n        let __editable = Boolean(editable);\n        return __editable;\n    }\n\n    //检查序列\n    _checkParamSQ(sq) {\n        let __sq = sq.split(\",\");\n        if (__sq.length != this._total_levels) {\n            throw `[checkParams]:奇穴应为${this._total_levels}重,请检查`;\n        }\n        return sq;\n    }\n\n    //设置私有数据\n    _setConfig(opt) {\n        this.version = opt.version;\n        this.xf = opt.xf;\n        this.map = this._data[opt.xf];\n        this.sq = opt.sq.split(\",\");\n        this.editable = opt.editable;\n        this.code = {version:opt.version,xf:opt.xf,sq:opt.sq}\n        this.overview = this._buildTalentOutputData(this.sq,this.map)\n    }\n\n    //构建奇穴有效吐出数据\n    _buildTalentOutputData(sq,data){\n        let overview = []\n        sq.forEach((item,i) => {\n            let _record = data[i + 1][item]\n            overview.push({\n                id : ~~_record.id,\n                icon : ~~_record.icon,\n                name : _record.name\n            })\n        })\n        return overview\n    }\n\n    //结构化容器\n    _structureViewBox(opt) {\n        //如果未定义容器，使用默认容器\n        if (opt.container == undefined) {\n            this.container = $(this._default.container);\n            //如果有定义容器\n        } else {\n            if ($(opt.container).length == 0) {\n                throw `[checkParams]:指定容器不存在,请检查`;\n            }\n            this.container = $(opt.container);\n        }\n\n        //结构化包裹层\n        this.container.append(`\n            <div class=\"w-qixue-box ${this.isQQBrowser && 'isQQBrowser'}\">\n                <div class=\"w-qixue-xf\">奇穴</div>\n                <ul class=\"w-qixue-clist\"></ul>\n                <div class=\"w-qixue-obox\"></div>\n            </div>\n        `);\n\n        //缓存渲染容器jq对象\n        this._box = this.container.children(\".w-qixue-box\");\n        this._xfbox = this._box.children(\".w-qixue-xf\");\n        this._clist = this._box.children(\".w-qixue-clist\");\n        this._obox = this._box.children(\".w-qixue-obox\");\n\n        //结构化当前list\n        let __clist = `\n            <li class=\"w-qixue-clist-item\">\n                <span class=\"u-pic\"><img src=\"\" alt=\"\"/></span>\n                <span class=\"u-title\"></span>\n            </li>\n        `.repeat(this._total_levels);\n        this._clist.append(__clist);\n        this._citems = this._clist.children(\".w-qixue-clist-item\");\n    }\n\n    //渲染展示容器\n    _renderViewBox() {\n        let __instance = this;\n        let __items = this._citems;\n\n        //console.log(this)\n\n        //心法名称\n        this._xfbox.text(this.xf);\n\n        //奇穴单项数据加载\n        $.each(__instance.sq, function (i, val) {\n            let level = __instance.map[i + 1];\n            let point = level[val];\n            //console.log(`第${i + 1}重：`,level)\n\n            //标签属性\n            $.each(__instance._item_attr_list, function (j, key) {\n                __items.eq(i).attr(`data-${key}`, point[key]);\n            });\n\n            //图片与文字\n            let icon_url = `${__instance._img_path + point[\"icon\"]}.png`;\n\n            __items.eq(i).find(\"img\").attr(\"src\", `${icon_url}`);\n            __items.eq(i).find(\"img\").attr(\"alt\", point[\"name\"]);\n            __items.eq(i).find(\".u-title\").text(point[\"name\"]);\n\n            //是否为特殊技能\n            parseInt(point[\"is_skill\"])\n                ? __items.eq(i).addClass(\"w-qixue-is_skill\")\n                : __items.eq(i).removeClass(\"w-qixue-is_skill\");\n\n            __instance.txt[i] = point[\"name\"];\n        });\n\n        this._loadMetaEvent(this._clist);\n    }\n\n    //构建编辑容器\n    _buildEditBox() {\n        //给总容器添加class钩子以控制是否显示展开/折叠图标\n        this._box.addClass(\"w-qixue-editable\");\n\n        //创建每重奇穴中的列表容器\n        let __olist = `\n            <ul class=\"w-qixue-olist\"></ul>\n        `.repeat(this._total_levels);\n        this._obox.html(__olist);\n        this._olist = this._obox.children(\".w-qixue-olist\");\n\n        //给每一重创建子列表\n        let __instance = this;\n        $.each(__instance.map, function (i, level) {\n            $.each(level, function (j, point) {\n                __instance._olist.eq(i - 1).append(`\n                    <li class=\"w-qixue-olist-item\" \n                        data-id=\"${point[\"id\"]}\" \n                        data-icon=\"${point[\"icon\"]}\" \n                        data-name=\"${point[\"name\"]}\"\n                        data-desc=\"${point[\"desc\"]}\"\n                        data-order=\"${point[\"order\"]}\"\n                        data-pos=\"${point[\"pos\"]}\"\n                        data-is_skill=\"${point[\"is_skill\"]}\"\n                        data-meta=\"${point[\"meta\"]}\"\n                        data-extend=\"${point[\"extend\"]}\"\n                    >\n                        <span class=\"u-pic\"><img src=\"${\n                            __instance._img_path + point[\"icon\"]\n                        }.png\" alt=\"${point[\"name\"]}\"/></span>\n                        <span class=\"u-title\">${point[\"name\"]}</span>\n                    </li>\n                `);\n            });\n        });\n\n        //给技能类增加样式\n        this._olist.find(\".w-qixue-olist-item\").each(function (i, ele) {\n            if (parseInt($(this).attr(\"data-is_skill\")))\n                $(this).addClass(\"w-qixue-is_skill\");\n        });\n\n        //绑定事件\n        this._bindEvent();\n    }\n\n    //绑定事件\n    _bindEvent() {\n        //step.1 点击展开/折叠事件\n        this._foldListEvent();\n\n        //step.2 加载奇穴信息\n        this._loadMetaEvent(this._olist);\n\n        //step.3 切换奇穴\n        this._changeEvent();\n    }\n\n    //展开折叠事件\n    _foldListEvent() {\n        let __instance = this;\n\n        //防止切换心法后多次绑定,需要先解绑\n        this._clist.off(\"click\", \"li\").on(\"click\", \"li\", function (e) {\n            e.stopPropagation();\n\n            let i = $(this).index();\n\n            //折叠按钮变化\n            $(this).siblings(\"li\").removeClass(\"on\");\n            $(this).toggleClass(\"on\");\n\n            //任意一个展开\n            __instance._clist.find(\".on\").length\n                ? __instance._obox.addClass(\"on\")\n                : __instance._obox.removeClass(\"on\");\n\n            //展开可选菜单\n            __instance._olist.removeClass(\"on\");\n            if ($(this).hasClass(\"on\")) {\n                __instance._olist.eq(i).addClass(\"on\");\n            }\n        });\n\n        //点击任意空白处\n        $(\"body\").on(\"click\", function () {\n            __instance._clist.children(\"li\").removeClass(\"on\");\n            __instance._obox.removeClass(\"on\");\n            __instance._olist.removeClass(\"on\");\n        });\n    }\n\n    //加载奇穴信息\n    _loadMetaEvent(list) {\n        //加载描述\n        $(list).on(\"mouseenter\", \"li\", function () {\n            let name = $(this).attr(\"data-name\");\n            let meta = $(this).attr(\"data-meta\");\n            let is_skill = Boolean(parseInt($(this).attr(\"data-is_skill\")));\n            let skill_type = is_skill ? \"主动招式\" : \"被动招式\";\n            let desc = $(this).attr(\"data-desc\");\n            let extend = $(this).attr(\"data-extend\");\n\n            let isNotExist = $(this).children(\".w-qixue-item-pop\").length == 0;\n            let __html = `<b class=\"u-name\">${name}</b>`;\n                __html += `<b class=\"u-skill\">${skill_type}</b>`;\n                if (is_skill && meta != \"null\" && meta != undefined)\n                    __html += `<em class=\"u-meta\">${meta}</em>`;\n                __html += `<span class=\"u-desc\">${desc}</span>`;\n                if (is_skill && extend != \"null\" && meta != undefined)\n                    __html += `<em class=\"u-extend\">${extend}</em>`;\n\n            if (isNotExist) {\n                let wrapper_prefix =`<span class=\"w-qixue-item-pop\">`\n                let wrapper_suffix = `</span>`\n                $(this).append(wrapper_prefix + __html + wrapper_suffix);\n            }else{\n                $(this).children(\".w-qixue-item-pop\").html(__html)\n            }\n        });\n        //控制显示隐藏显示\n        $(list).on(\"mouseenter\", \"li\", function () {\n            $(this).children(\".w-qixue-item-pop\").addClass(\"on\");\n        });\n        $(list).on(\"mouseleave\", \"li\", function () {\n            $(this).children(\".w-qixue-item-pop\").removeClass(\"on\");\n        });\n    }\n\n    //切换奇穴\n    _changeEvent() {\n        let __instance = this;\n        this._olist.on(\"click\", \"li\", function (e) {\n            //缓存选择\n            let $from = $(this);\n            let __order = $from.parent(\"ul\").index();\n            let $to = __instance._citems.eq(__order);\n\n            //更改li属性\n            $.each(__instance._item_attr_list, function (i, val) {\n                $to.attr(`data-${val}`, $from.attr(`data-${val}`));\n            });\n\n            //更改图片&标题\n            $to.find(\"img\").attr(\n                \"src\",\n                `${__instance._img_path + $from.attr(\"data-icon\")}.png`\n            );\n            $to.find(\"img\").attr(\"alt\", $from.attr(\"data-name\"));\n            $to.find(\".u-title\").text($from.attr(\"data-name\"));\n\n            //添加特殊技能样式\n            parseInt($from.attr(\"data-is_skill\"))\n                ? $to.addClass(\"w-qixue-is_skill\")\n                : $to.removeClass(\"w-qixue-is_skill\");\n\n            //更新内部数据\n            __instance.sq[__order] = $from.attr(\"data-pos\");\n            __instance.txt[__order] = $from.attr(\"data-name\");\n            __instance.code.sq = __instance.sq.toString()\n            __instance.overview[__order] = {\n                id : ~~$from.attr(\"data-id\"),\n                icon : ~~$from.attr(\"data-icon\"),\n                name : $from.attr(\"data-name\"),\n            }\n\n            //触发自定义事件\n            $(document).trigger(\"JX3_QIXUE_Change\", __instance);\n        });\n    }\n\n    /* 公开方法 \n    ------------------------------------------\n    */\n\n    //重加载渲染数据\n    load(opt) {\n        if (opt == undefined) return;\n\n        let __opt = {};\n        __opt = this._checkParam(opt);\n\n        return this._build(__opt).then((data) => {\n            $(document).trigger(\"JX3_QIXUE_Change\", this);\n            return data;\n        });\n    }\n}\n\nexport default JX3_QIXUE;\n\n//测试用例\n/* let test = new JX3_QIXUE({\n    \"xf\":\"冰心诀\",\n    \"sq\":\"1,2,4,1,2,3,1,2,3,4,4,4\",\n    \"editable\":true\n});\nconsole.log(test)\ntest.load(`{\n    \"xf\":\"冰心诀\",\n    \"sq\":\"1,2,4,1,2,3,1,2,3,4,4,4\",\n    \"editable\":true\n}`)\ntest.load('冰心诀,111111222222,true')\ntest.ready(function (o){\n    console.log(o)\n}) */\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('app-layout',{attrs:{\"slug\":\"talent\"}},[_c('div',{staticClass:\"m-talent\"},[_c('div',{staticClass:\"m-talent-header\"},[_c('h1',{staticClass:\"m-talent-title\"},[_vm._v(\"奇穴模拟器\")]),_c('div',{staticClass:\"m-talent-panel\"},[_c('div',{staticClass:\"m-talent-version\"},[_c('span',{staticClass:\"u-label\"},[_vm._v(\"选择版本\")]),_c('el-select',{attrs:{\"placeholder\":\"请选择游戏版本\",\"popper-class\":\"m-talent__pop\"},on:{\"change\":_vm.reload},model:{value:(_vm.version),callback:function ($$v) {_vm.version=$$v},expression:\"version\"}},_vm._l((_vm.versions),function(item){return _c('el-option',{key:item.version,attrs:{\"label\":item.name,\"value\":item.version}},[_c('div',{staticClass:\"m-talent__option\"},[_c('span',{staticClass:\"u-label\"},[_vm._v(_vm._s(item.name))]),_c('span',{staticClass:\"u-version\"},[_vm._v(_vm._s(item.version))])])])}),1)],1),(_vm.isLogin)?_c('div',{staticClass:\"u-toolbar\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-setting\",\"size\":\"small\"},on:{\"click\":function($event){_vm.drawer = true}}},[_vm._v(\"我的预设\")])],1):_vm._e()])]),_c('div',{staticClass:\"m-talent-wrapper\"},[_c('h2',{staticClass:\"m-talent-subtitle\"},[_vm._v(\"选择心法\")]),_c('div',{staticClass:\"m-talent-xf\"},_vm._l((_vm.xfMaps),function(item,i){return _c('el-radio',{key:i,attrs:{\"label\":item.name},on:{\"change\":_vm.reload},model:{value:(_vm.xf),callback:function ($$v) {_vm.xf=$$v},expression:\"xf\"}},[_c('img',{staticClass:\"u-pic\",attrs:{\"src\":_vm.xficon(item.id),\"alt\":item.name}}),_c('span',{staticClass:\"u-txt\"},[_vm._v(_vm._s(item.name))])])}),1),_c('h2',{staticClass:\"m-talent-subtitle\"},[_vm._v(\"配置奇穴\")]),_c('div',{staticClass:\"qx-container\"}),_c('h2',{staticClass:\"m-talent-subtitle\"},[_vm._v(\"奇穴编码\")]),_c('div',{staticClass:\"m-talent-code\"},[_c('el-input',{attrs:{\"placeholder\":\"粘贴编码亦可自动解析奇穴\"},on:{\"change\":_vm.parseSchema},model:{value:(_vm.code),callback:function ($$v) {_vm.code=$$v},expression:\"code\"}},[_c('span',{staticClass:\"u-copy\",attrs:{\"slot\":\"prepend\"},on:{\"click\":function($event){return _vm.copy(_vm.code)}},slot:\"prepend\"},[_c('i',{staticClass:\"el-icon-document-copy\"}),_vm._v(\" 点击复制 \")])])],1),(_vm.isEditor)?_c('div',{staticClass:\"m-talent-code\"},[_c('h2',{staticClass:\"m-talent-subtitle\"},[_vm._v(\"配装编码\")]),_c('el-input',{attrs:{\"placeholder\":\"配装器编码\"},model:{value:(_vm.pzcode),callback:function ($$v) {_vm.pzcode=$$v},expression:\"pzcode\"}},[_c('span',{staticClass:\"u-copy\",attrs:{\"slot\":\"prepend\"},on:{\"click\":function($event){return _vm.copy(_vm.pzcode)}},slot:\"prepend\"},[_c('i',{staticClass:\"el-icon-document-copy\"}),_vm._v(\" 点击复制 \")])])],1):_vm._e(),(_vm.isLogin)?_c('div',{staticClass:\"m-talent-op\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":_vm.currentSchema ? 'el-icon-check' : 'el-icon-document-add'},on:{\"click\":_vm.save}},[_vm._v(_vm._s(_vm.currentSchema ? \"保存\" : \"保存为预设\"))]),(_vm.isEditing)?_c('el-button',{staticClass:\"u-btn\",attrs:{\"type\":\"success\",\"icon\":\"el-icon-document-add\",\"plain\":\"\"},on:{\"click\":_vm.saveAs}},[_vm._v(\"另存为\")]):_vm._e()],1):_vm._e()]),(_vm.isLogin)?_c('talent-drawer',{attrs:{\"drawer\":_vm.drawer},on:{\"update-drawer\":_vm.updateDrawer,\"use\":_vm.use}}):_vm._e()],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <app-layout slug=\"talent\">\n        <div class=\"m-talent\">\n            <div class=\"m-talent-header\">\n                <h1 class=\"m-talent-title\">奇穴模拟器</h1>\n                <div class=\"m-talent-panel\">\n                    <div class=\"m-talent-version\">\n                        <span class=\"u-label\">选择版本</span>\n                        <el-select\n                            v-model=\"version\"\n                            placeholder=\"请选择游戏版本\"\n                            @change=\"reload\"\n                            popper-class=\"m-talent__pop\"\n                        >\n                            <el-option\n                                v-for=\"item in versions\"\n                                :key=\"item.version\"\n                                :label=\"item.name\"\n                                :value=\"item.version\"\n                            >\n                                <div class=\"m-talent__option\">\n                                    <span class=\"u-label\">{{ item.name }}</span>\n                                    <span class=\"u-version\">{{ item.version }}</span>\n                                </div>\n                            </el-option>\n                        </el-select>\n                    </div>\n                    <div class=\"u-toolbar\" v-if=\"isLogin\">\n                        <!-- <el-button plain @click=\"showList = false\" icon=\"el-icon-refresh-left\" size=\"small\" v-if=\"showList\">返回</el-button> -->\n                        <!-- <el-button type=\"primary\" @click=\"showList = true\" icon=\"el-icon-setting\" size=\"small\" v-else>我的预设</el-button> -->\n                        <el-button type=\"primary\" @click=\"drawer = true\" icon=\"el-icon-setting\" size=\"small\"\n                            >我的预设</el-button\n                        >\n                    </div>\n                </div>\n            </div>\n            <div class=\"m-talent-wrapper\">\n                <h2 class=\"m-talent-subtitle\">选择心法</h2>\n                <div class=\"m-talent-xf\">\n                    <el-radio v-for=\"(item, i) in xfMaps\" v-model=\"xf\" :label=\"item.name\" :key=\"i\" @change=\"reload\">\n                        <img class=\"u-pic\" :src=\"xficon(item.id)\" :alt=\"item.name\" />\n                        <span class=\"u-txt\">{{ item.name }}</span>\n                    </el-radio>\n                </div>\n                <h2 class=\"m-talent-subtitle\">配置奇穴</h2>\n                <div class=\"qx-container\"></div>\n                <h2 class=\"m-talent-subtitle\">奇穴编码</h2>\n                <div class=\"m-talent-code\">\n                    <el-input placeholder=\"粘贴编码亦可自动解析奇穴\" v-model=\"code\" @change=\"parseSchema\">\n                        <span slot=\"prepend\" @click=\"copy(code)\" class=\"u-copy\">\n                            <i class=\"el-icon-document-copy\"></i>\n                            点击复制\n                        </span>\n                    </el-input>\n                </div>\n                <div class=\"m-talent-code\" v-if=\"isEditor\">\n                    <h2 class=\"m-talent-subtitle\">配装编码</h2>\n                    <el-input placeholder=\"配装器编码\" v-model=\"pzcode\">\n                        <span slot=\"prepend\" @click=\"copy(pzcode)\" class=\"u-copy\">\n                            <i class=\"el-icon-document-copy\"></i>\n                            点击复制\n                        </span>\n                    </el-input>\n                </div>\n                <div class=\"m-talent-op\" v-if=\"isLogin\">\n                    <el-button\n                        type=\"primary\"\n                        :icon=\"currentSchema ? 'el-icon-check' : 'el-icon-document-add'\"\n                        @click=\"save\"\n                        >{{ currentSchema ? \"保存\" : \"保存为预设\" }}</el-button\n                    >\n                    <el-button\n                        v-if=\"isEditing\"\n                        type=\"success\"\n                        icon=\"el-icon-document-add\"\n                        class=\"u-btn\"\n                        @click=\"saveAs\"\n                        plain\n                        >另存为</el-button\n                    >\n                </div>\n            </div>\n\n            <talent-drawer v-if=\"isLogin\" :drawer=\"drawer\" @update-drawer=\"updateDrawer\" @use=\"use\"></talent-drawer>\n        </div>\n    </app-layout>\n</template>\n\n<script>\nimport xfmap from \"@jx3box/jx3box-data/data/xf/xf.json\";\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\nimport JX3_QIXUE from \"@jx3box/jx3box-talent\";\nimport $ from \"jquery\";\nimport schemas from \"@/assets/data/schemas.json\";\nimport cloneDeep from \"lodash/cloneDeep\";\nimport { getTalentVersions, getTalents, addTalent, putTalent, removeTalent } from \"@/service/talent.js\";\nimport User from \"@jx3box/jx3box-common/js/user\";\nimport talentDrawer from \"@/components/talent/talent_drawer.vue\";\nimport { copy } from \"@/utils/clipboard\";\nimport AppLayout from \"@/layout/AppLayout.vue\";\nexport default {\n    name: \"Talent\",\n    props: [],\n    data: function () {\n        return {\n            activeName: \"common\",\n            xf: \"其它\",\n            sq: \"1,1,1,1,1,1,1,1,1,1,1,1\",\n            driver: \"\",\n            code: \"\",\n            pzcode: \"\",\n\n            version: \"\",\n            versions: [],\n            schemas,\n\n            isLogin: User.isLogin(),\n            isEditor: false,\n            showList: false,\n            drawer: false,\n\n            currentSchema: \"\",\n        };\n    },\n    computed: {\n        schema_group: function () {\n            return schemas[this.xf];\n        },\n        mount: function () {\n            return xfmap[this.xf]?.id;\n        },\n        params: function () {\n            const { mount, version, code, pzcode, xf } = this;\n            return {\n                client: 'std',\n                type: \"talent\",\n                mount,\n                version,\n                code: JSON.parse(code),\n                pzcode: JSON.parse(pzcode),\n                xf,\n            };\n        },\n        xfMaps: function () {\n            const xfMaps = cloneDeep(xfmap);\n            delete xfMaps[\"山居剑意\"];\n            return xfMaps;\n        },\n        isEditing: function () {\n            return !!this.currentSchema;\n        },\n    },\n    methods: {\n        updateDrawer: function (val) {\n            this.drawer = val;\n        },\n        parseSchema: function () {\n            this.driver.then((talent) => {\n                // 为空不操作\n                if (!this.code) return;\n\n                let _schema = {};\n                try {\n                    _schema = JSON.parse(this.code);\n                    talent.load(_schema);\n                    this.$message({\n                        message: \"编码解析成功\",\n                        type: \"success\",\n                    });\n                } catch (e) {\n                    this.$message.error(\"编码格式错误\");\n                }\n            });\n        },\n        reload: function (schema) {\n            this.currentSchema = \"\";\n            this.driver.then((talent) => {\n                talent.load({\n                    version: this.version,\n                    xf: this.xf,\n                    sq: this.sq,\n                    editable: true,\n                });\n            });\n        },\n        copy: function (val) {\n            if (!val) return;\n            copy(val, { success_message: \"复制奇穴编码成功\" });\n        },\n\n        // 预设方案\n        save: function () {\n            if (!this.mount) {\n                this.$notify({\n                    type: \"warning\",\n                    title: \"提醒\",\n                    message: \"暂未选择心法，请先选择心法\",\n                });\n                return;\n            }\n\n            if (this.isEditing) {\n                putTalent(this.currentSchema.id, {\n                    ...this.params,\n                }).then(() => {\n                    this.$notify({\n                        type: \"success\",\n                        title: \"成功\",\n                        message: \"修改成功\",\n                    });\n                });\n            } else {\n                this.$prompt(\"请输入方案名称\", \"提示\", {\n                    confirmButtonText: \"确定\",\n                    cancelButtonText: \"取消\",\n                    inputErrorMessage: \"输入不能为空\",\n                    inputValidator: (value) => {\n                        // 点击按钮时，对文本框里面的值进行验证\n                        if (!value) {\n                            return \"输入不能为空\";\n                        }\n                    },\n                }).then(({ value }) => {\n                    addTalent({\n                        ...this.params,\n                        name: value,\n                    }).then(() => {\n                        this.$notify({\n                            type: \"success\",\n                            title: \"成功\",\n                            message: \"保存成功\",\n                        });\n                    });\n                });\n            }\n        },\n        saveAs: function () {\n            this.$prompt(\"方案另存为\", \"提示\", {\n                confirmButtonText: \"确定\",\n                cancelButtonText: \"取消\",\n                inputErrorMessage: \"输入不能为空\",\n                inputValue: this.currentSchema?.name,\n                inputValidator: (value) => {\n                    // 点击按钮时，对文本框里面的值进行验证\n                    if (!value) {\n                        return \"输入不能为空\";\n                    }\n                },\n            }).then(({ value }) => {\n                addTalent({\n                    ...this.params,\n                    name: value,\n                }).then(() => {\n                    this.$notify({\n                        type: \"success\",\n                        title: \"成功\",\n                        message: \"保存成功\",\n                    });\n                });\n            });\n        },\n        use: function (item) {\n            this.code = JSON.stringify(item.code);\n            this.pzcode = JSON.stringify(item.pzcode);\n\n            const parseCode = JSON.parse(this.code);\n\n            this.xf = parseCode.xf;\n\n            this.currentSchema = item;\n\n            this.parseSchema();\n        },\n        init: function () {\n            getTalentVersions().then((res) => {\n                this.versions = res.data;\n                this.version = this.versions && this.versions.length && this.versions[0][\"version\"];\n\n                this.driver = new JX3_QIXUE({\n                    version: this.version,\n                    editable: true,\n                });\n                const vm = this;\n                $(document).on(\"JX3_QIXUE_Change\", function (e, ins) {\n                    let __data = {};\n                    __data.version = ins.version;\n                    __data.xf = ins.xf;\n                    __data.sq = ins.sq.join(\",\");\n                    vm.code = JSON.stringify(__data);\n\n                    vm.pzcode = JSON.stringify(ins.overview);\n                });\n            });\n        },\n        xficon: function (id) {\n            return __imgPath + \"image/xf/\" + id + \".png\";\n        },\n    },\n    mounted: function () {\n        this.init();\n        this.isEditor = User.isEditor();\n    },\n    watch: {\n        page: function () {\n            this.isLogin && this.loadList();\n        },\n    },\n    components: {\n        talentDrawer,\n        AppLayout,\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"~@/assets/css/talent.less\";\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Talent.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Talent.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Talent.vue?vue&type=template&id=bfe8b4ae\"\nimport script from \"./Talent.vue?vue&type=script&lang=js\"\nexport * from \"./Talent.vue?vue&type=script&lang=js\"\nimport style0 from \"./Talent.vue?vue&type=style&index=0&id=bfe8b4ae&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Talent.vue?vue&type=style&index=0&id=bfe8b4ae&prod&lang=less\""],"sourceRoot":""}